{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\shuga\\\\Documents\\\\GitU\\\\IIMAS\\\\iimas_auth_frontend\\\\src\\\\pages\\\\login\\\\Login.js\";\nimport React, { Component, Fragment } from 'react';\nimport { withNamespaces } from 'react-i18next';\nimport Webcam from 'react-webcam';\nimport { loadModels, getFullFaceDescription, createMatcher } from '../../components/api/face';\nimport DrawBox from '../../components/api/DrawBox';\nimport * as JSON_PROFILE from '../../components/api/showDescriptors';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst WIDTH = 420;\nconst HEIGHT = 420;\nconst inputSize = 160;\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n\n    this.setInputDevice = () => {\n      navigator.mediaDevices.enumerateDevices().then(async devices => {\n        let inputDevice = await devices.filter(device => device.kind === 'videoinput');\n\n        if (inputDevice.length < 2) {\n          await this.setState({\n            facingMode: 'user'\n          });\n        } else {\n          await this.setState({\n            facingMode: {\n              exact: 'environment'\n            }\n          });\n        }\n\n        this.startCapture();\n      });\n    };\n\n    this.matcher = async () => {\n      const faceMatcher = await createMatcher(JSON_PROFILE);\n      console.log('faceMatcher', faceMatcher.labeledDescriptors);\n      this.setState({\n        faceMatcher\n      });\n    };\n\n    this.startCapture = () => {\n      this.interval = setInterval(() => {\n        this.capture();\n      }, 1500);\n    };\n\n    this.capture = async () => {\n      if (!!this.webcam.current) {\n        await getFullFaceDescription(this.webcam.current.getScreenshot(), inputSize).then(fullDesc => this.setState({\n          fullDesc\n        }));\n      }\n    };\n\n    this.webcam = /*#__PURE__*/React.createRef();\n    this.state = {\n      fullDesc: null,\n      faceMatcher: null,\n      facingMode: null\n    };\n  }\n\n  componentWillMount() {\n    loadModels();\n    this.setInputDevice();\n    this.matcher();\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  render() {\n    const {\n      fullDesc,\n      faceMatcher,\n      facingMode\n    } = this.state;\n    let videoConstraints = null;\n    let camera = '';\n\n    if (!!facingMode) {\n      videoConstraints = {\n        width: WIDTH,\n        height: HEIGHT,\n        facingMode: facingMode\n      };\n\n      if (facingMode === 'user') {\n        camera = 'Front';\n      } else {\n        camera = 'Back';\n      }\n    }\n\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Camera\",\n      style: {\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center'\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Camera: \", camera]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          width: WIDTH,\n          height: HEIGHT\n        },\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            position: 'relative',\n            width: WIDTH\n          },\n          children: [!!videoConstraints ? /*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              position: 'absolute'\n            },\n            children: /*#__PURE__*/_jsxDEV(Webcam, {\n              audio: false,\n              width: WIDTH,\n              height: HEIGHT,\n              ref: this.webcam,\n              screenshotFormat: \"image/jpeg\",\n              videoConstraints: videoConstraints\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 108,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 33\n          }, this) : null, !!fullDesc ? /*#__PURE__*/_jsxDEV(DrawBox, {\n            fullDesc: fullDesc,\n            faceMatcher: faceMatcher,\n            imageWidth: WIDTH,\n            boxColor: 'blue'\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 33\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 105,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 99,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 17\n    }, this);\n  }\n\n}\n\nexport default withNamespaces()(Login);","map":{"version":3,"sources":["C:/Users/shuga/Documents/GitU/IIMAS/iimas_auth_frontend/src/pages/login/Login.js"],"names":["React","Component","Fragment","withNamespaces","Webcam","loadModels","getFullFaceDescription","createMatcher","DrawBox","JSON_PROFILE","WIDTH","HEIGHT","inputSize","Login","constructor","props","setInputDevice","navigator","mediaDevices","enumerateDevices","then","devices","inputDevice","filter","device","kind","length","setState","facingMode","exact","startCapture","matcher","faceMatcher","console","log","labeledDescriptors","interval","setInterval","capture","webcam","current","getScreenshot","fullDesc","createRef","state","componentWillMount","componentWillUnmount","clearInterval","render","videoConstraints","camera","width","height","display","flexDirection","alignItems","position"],"mappings":"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","sourcesContent":["import React, {Component, Fragment} from 'react';\r\nimport { withNamespaces } from 'react-i18next';\r\nimport Webcam from 'react-webcam';\r\nimport { loadModels, getFullFaceDescription, createMatcher } from '../../components/api/face';\r\nimport DrawBox from '../../components/api/DrawBox';\r\nimport * as JSON_PROFILE from '../../components/api/showDescriptors';\r\n\r\nconst WIDTH = 420;\r\nconst HEIGHT = 420;\r\nconst inputSize = 160;\r\n\r\n    class Login extends Component {\r\n        constructor(props) {\r\n            super(props);\r\n            this.webcam = React.createRef();\r\n            this.state = {\r\n                fullDesc: null,\r\n                faceMatcher: null,\r\n                facingMode: null\r\n            };\r\n        }\r\n\r\n        componentWillMount() {\r\n            loadModels();\r\n            this.setInputDevice();\r\n            this.matcher();\r\n        }\r\n\r\n        setInputDevice = () => {\r\n            navigator.mediaDevices.enumerateDevices().then(async devices => {\r\n                let inputDevice = await devices.filter(\r\n                    device => device.kind === 'videoinput'\r\n                );\r\n                if (inputDevice.length < 2) {\r\n                    await this.setState({\r\n                        facingMode: 'user'\r\n                    });\r\n                } else {\r\n                    await this.setState({\r\n                        facingMode: { exact: 'environment' }\r\n                    });\r\n                }\r\n                this.startCapture();\r\n            });\r\n        };\r\n\r\n        matcher = async () => {\r\n            const faceMatcher = await createMatcher(JSON_PROFILE);\r\n            console.log('faceMatcher', faceMatcher.labeledDescriptors)\r\n            this.setState({ faceMatcher });\r\n        };\r\n\r\n        startCapture = () => {\r\n            this.interval = setInterval(() => {\r\n                this.capture();\r\n            }, 1500);\r\n        };\r\n\r\n        componentWillUnmount() {\r\n            clearInterval(this.interval);\r\n        }\r\n\r\n        capture = async () => {\r\n            if (!!this.webcam.current) {\r\n                await getFullFaceDescription(\r\n                    this.webcam.current.getScreenshot(),\r\n                    inputSize\r\n                ).then(fullDesc => this.setState({ fullDesc }));\r\n            }\r\n        };\r\n\r\n        render() {\r\n            const { fullDesc, faceMatcher, facingMode } = this.state;\r\n            let videoConstraints = null;\r\n            let camera = '';\r\n            if (!!facingMode) {\r\n                videoConstraints = {\r\n                    width: WIDTH,\r\n                    height: HEIGHT,\r\n                    facingMode: facingMode\r\n                };\r\n                if (facingMode === 'user') {\r\n                    camera = 'Front';\r\n                } else {\r\n                    camera = 'Back';\r\n                }\r\n            }\r\n\r\n            return (\r\n                <div\r\n                    className=\"Camera\"\r\n                    style={{\r\n                        display: 'flex',\r\n                        flexDirection: 'column',\r\n                        alignItems: 'center'\r\n                    }}\r\n                >\r\n                    <p>Camera: {camera}</p>\r\n                    <div\r\n                        style={{\r\n                            width: WIDTH,\r\n                            height: HEIGHT\r\n                        }}\r\n                    >\r\n                        <div style={{ position: 'relative', width: WIDTH }}>\r\n                            {!!videoConstraints ? (\r\n                                <div style={{ position: 'absolute' }}>\r\n                                    <Webcam\r\n                                        audio={false}\r\n                                        width={WIDTH}\r\n                                        height={HEIGHT}\r\n                                        ref={this.webcam}\r\n                                        screenshotFormat=\"image/jpeg\"\r\n                                        videoConstraints={videoConstraints}\r\n                                    />\r\n                                </div>\r\n                            ) : null}\r\n                            {!!fullDesc ? (\r\n                                <DrawBox\r\n                                    fullDesc={fullDesc}\r\n                                    faceMatcher={faceMatcher}\r\n                                    imageWidth={WIDTH}\r\n                                    boxColor={'blue'}\r\n                                />\r\n                            ) : null}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n        }\r\n    }\r\n\r\nexport default withNamespaces()(Login);\r\n"]},"metadata":{},"sourceType":"module"}